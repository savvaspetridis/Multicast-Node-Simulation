<!--

index.html for Multicast Simulator app:

by: Raphael Norwitz and Savvas Petridis

Note: This page is a template using both AngularJS and Django syntax, which sometimes cause syntax collisions. 
The solution to htis is to use verbatim tags, which are all in comments. Thus do not alter any comments in this template as 
they will affect how django parses the code.

-->


<!doctype html>
<html lang="en" ng-app="app">


<!--{% verbatim %}-->


<head>
	<meta charset="UTF-8">
	<title> multicast simulator </title>

	<!--

	This style tag contains all the styles currently used in this page. 
	The 'fixed' tag fixes the table cell size.
	The generic table tag ensures that the table has borders
	the .something tags are all used to color the cells. 
	To add another color to the simulator, add a .someColor tag where someColor is the color you
	want to add, and just set the background-color attribute equal to the color you want. 
	See comments on the <td> tag for next instruction on adding colors


	-->
	<style type="text/css">

	table.fixed { table-layout:fixed; }
	table.fixed td { overflow: hidden; }

	table, th, td {
		border: 1px solid black;

	}
	.feedback{
		outline: red dotted thick;
	}
	.green {
		background-color: LightGreen;	 
	}
	.yellow
	{
		background-color: yellow;
	}
	.blue
	{
		background-color: LightBlue;
	}
	.red
	{
		background-color: FireBrick;
	}
	.grey
	{
		background-color: LightGrey;
	}
	.black
	{
		background-color: black;
	}

	</style>

	<!--these scripts import angular and raphael js-->
	<script src="http://code.angularjs.org/1.2.2/angular.min.js"> </script>
	<script type="text/javascript" src="http://github.com/DmitryBaranovskiy/raphael/raw/master/raphael-min.js"></script>
	<script src="bower_components/angular-chart.js/angular-chart.js"></script>
	<script src="bower_compnents/Chart.js/Chart.min.js"></script>




</head>


<body >
	<h1 align = "center"><b>Multicast Simulator</b></h1>


<!--this whole div creates the table-->
<div ng-controller= "theController" align = "center">
	<div>

	<!--{% endverbatim %} -->

	<form action="." method="post"> {% csrf_token %}
		<div class="fieldWrapper" ng-show="showBitRate">
			<label for="{{ form.bitRate.id_for_label }}" >Bit Rate:</label>
			{{ form.bitRate }}
		</div>
		<div class="fieldWrapper">
			<label for="{{ form.updateInterval.id_for_label }}">Update Interval:</label>
			{{ form.updateInterval }}
		</div>
		<div class="fieldWrapper">
			<label for="{{ form.fbNodeAlg.id_for_label }}">F.B.N. Algorithm:</label>
			{{ form.fbNodeAlg }}
			<label for="{{ form.fbNodeAlg.id_for_label }}" ng-show="showK">k:</label>
			{{ form.k }}
			<label for="{{ form.fbNodeAlg.id_for_label }}" ng-show="showDistance">Distance (Amuse):</label>
			{{ form.d }}
		</div>
		<div class="fieldWrapper" ng-hidew="showBitRate">
			<label for="{{ form.fbNodeAlg.id_for_label }}">H-low Threshold</label>
			{{ form.H}}
			<label for="{{ form.fbNodeAlg.id_for_label }}">Variability of PDR allowed</label>
			{{ form.Delta}}
			<label for="{{ form.fbNodeAlg.id_for_label }}">Window minimum</label>
			{{ form.W_min}}
			<label for="{{ form.fbNodeAlg.id_for_label }}">Window maximum</label>
			{{ form.W_max}}
			<label for="{{ form.fbNodeAlg.id_for_label }}">Time</label>
			{{ form.time}}
			<label for="{{ form.fbNodeAlg.id_for_label }}">Maximum abnormal nodes</label>
			{{ form.A_max}}
		</div>
		<input type="submit" value="Submit"  />
	</form>

	<!-- {% verbatim %} -->
	
	<br />
	
	<b>

		<h2>{{(COUNTER * intervalCount)}} seconds</h2>
		

		
		<table class="fixed" width = "75%" >
			

			<th>
				<!--

				this ng-repeat iterates through the array of areas returned by django (lists of pdr values for each area)
				to find the area indexes (eg. 1-'', 2-'', 3-''...20-'') 				
				-->
				<td ng-repeat="area in Interval" width="4.85%">{{$index+1}}</td>

			</th>

			
			<!--
				
				This ng-repeat similarly loops through all the areas in the interval

			-->
			<tbody ng-repeat="area in Interval">
				<tr class="nodeRow">
					<!--gets the individual node numbers within the interval (the horizontal header on the table)-->
					<td>
						{{$index+1}}
					</td>
					<!--

						this tag both prints the node value in the box and determines the boxes color

						to add another color to the interval,  append the current string inside the {} in ng-class tag by:
						
						", 'x' : classSelectors[$parent.$index][$index][y]"

						where x is the color you want to add and y is the highest 'y' value in the expression thus far incremented by 1

						to finish adding a color see the comments inside the angular controller

					-->
					<td ng-repeat= "node in area track by $index" ng-class = "{'feedback' : classSelectors[$parent.$index][$index][0], 'grey' : classSelectors[$parent.$index][$index][1], 'blue' : classSelectors[$parent.$index][$index][2], 'yellow' : classSelectors[$parent.$index][$index][3], 'green' : classSelectors[$parent.$index][$index][4], 'black' : classSelectors[$parent.$index][$index][5], 'red' : classSelectors[$parent.$index][$index][6] }">
						{{node}}
						<!-- {% endverbatim %}-->
					</td>

				</tr> 
			</tbody>
			
		
		</table>
		<div>
			
			
	</b>
	<hr />
	<div>
		<button type="button" data-ng-click="play()">Play</button>
		<button type="button" data-ng-click="stop()">Pause</button>
	</div>
</div>
	

	
</div>


<!--{% load staticfiles %}-->

<script src="{% static "tableController.js" %}"></script>
<!--

	to bypass Django statics, uncomment this script tag and comment out the one above

	<script src="https://rawgit.com/savvaspetridis/Multicast-Node-Simulation/master/amuse_project/multicast_simulator/templates/multicast_simulator/tableController.js"> </script>
-->
	
</body>
</html>